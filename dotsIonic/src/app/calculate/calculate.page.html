<ion-header>
  <ion-toolbar>
    <ion-title>Calculate</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-item color="secondary">
    Nutrition
  </ion-item>

  <ion-card *ngFor="let param of paramsService.nutrition">
    <ion-card-header>
      <ion-icon name="nutrition" color="tertiary"></ion-icon>
      {{ param.Title }}
    </ion-card-header>
    <ion-card-content>

      <ion-list>

        <ion-item>
          Default goal: {{ param.Goal }}
        </ion-item>
        <ion-item *ngIf="formulas[param.Title]">

          <ion-grid>

            <ion-row>

              <ion-col>
                <ion-grid>

                  <ion-row *ngFor="let field of formulas[param.Title].required; let i = index">

                    <ion-col>
                      <ion-label style="max-width: 50%"> {{ field.Title }} </ion-label>
                    </ion-col>

                    <ion-col>

                      <ion-item lines="none" *ngIf="field.Type == 'number'" style="display: flex">
                        <ion-input 
                          *ngIf="field.Type == 'number'"
                          type="number" [(ngModel)]="values.nutrition[i]"></ion-input>
                        <ion-label style="margin-left: 0.5rem">{{ field.Unit }}</ion-label>
                      </ion-item>

                      <div *ngIf="field.Type == 'checkbox'">
                        <ion-radio-group value="field.Title">
                          <ion-item lines="none" *ngFor="let option of field.Options; let j = index">
                            <ion-radio
                              [name]="field.Title"
                              [(ngModel)]="values.nutrition[i]"
                              [value]="option.Title"></ion-radio>
                            
                            <ion-label style="margin-left: 0.5rem">{{ option.Title}}</ion-label>
                          </ion-item>
                        </ion-radio-group>
                      </div>

                      <div *ngIf="field.Type == 'select'">
                        <ion-select [(ngModel)]="values.nutrition[i]">
                          <ion-select-option *ngFor="let option of field.Options; let j = index"
                            [value]="option.Value">{{ option.Title }}</ion-select-option>
                        </ion-select>
                      </div>

                    </ion-col>

                  </ion-row>

                  <ion-row>
                    <ion-button (click)="calculate(param.Title, values.nutrition)">
                      Calculate
                    </ion-button>
                  </ion-row>

                </ion-grid>
              </ion-col>

            </ion-row>
            <ion-row>
              <ion-col>
                {{ result | json }}
              </ion-col>
            </ion-row>

          </ion-grid>

        </ion-item>

      </ion-list>

      {{ param | json }}

    </ion-card-content>
  </ion-card>

</ion-content>
