<ion-content class="gradient-1">

  <div id="workout-preview" *ngIf="current.ExerciseIndex == null">

    <div id="workout-summary">
      <h1>{{ sheetData.Title }} </h1>

      <ion-list>

        <ion-item color="none">
          <ion-icon name="grid" style="padding-right: 0.5rem"></ion-icon>
          {{ sheetData.Params.length }} {{ 'exercises' | translate }}
        </ion-item>

        <ion-item color="none">
          <ion-icon name="checkmark" style="padding-right: 0.5rem"></ion-icon>
          {{ sheetData.RecordsNum }} {{ 'records' | translate }}
        </ion-item>

        <ion-item color="none">

          <ion-icon name="timer" style="padding-right: 0.5rem"></ion-icon>
          <ion-label *ngIf="averageTime < 3600000">
            {{ averageTime | date:'mm':'UTC'}} {{ 'minutes' | translate }}
          </ion-label>
          <ion-label *ngIf="averageTime >= 3600000">
            {{ averageTime / 3600000 | number:'1.0-0' }} {{ 'h' | translate }}
            {{ averageTime % 3600000 | date:'mm':'UTC' }} {{ 'minutes' | translate }}
          </ion-label>

        </ion-item>

      </ion-list>
      
      <ion-button 
        (click)="startWorkout()"
        class="button-1-light" expand="full" size="large">
        <ion-icon name="play"></ion-icon>
      </ion-button>

      <ion-button 
        routerLink="/workouts"
        fill="clear" color="light" expand="full">
        {{ 'Cancel' | translate }}
      </ion-button>

    </div>

  </div>

  <ion-grid id="workout" *ngIf="current.ExerciseIndex != null">

    <ion-row>

      <ion-col
        sizeLg="4" sizeMd="5" sizeSm="12">
        
        <ion-card id="current">

          <div style="width: 100px; height: 50px; position: relative" >

            <div id="c1" style="position: absolute; bottom: 0px; width: 100px; height: 40px; background-color: red;"
            [style.height.%]="100 - (timerService.timePassed() / averageTime * 100)"></div>

          </div>

          <div style="width: 100px; height: 50px; position: relative">
            <div id="cf" style="width: 5px; height: 50px; background-color: red; z-index: 5"></div>
            <div id="c2" style="width: 100px; height: 0px; background-color: red; position: absolute; bottom: 0px"
            [style.height.%]="timerService.timePassed() / averageTime * 100"></div>
          </div>

          <ion-item>
            <div id="timer">
              <div id="time-passed"
                [style.width.%]="timerService.timePassed() / averageTime * 100"></div>
              <div id="time">
                {{ timerService.timePassed() | date:'HH:mm:ss':'UTC' }}
              </div>
            </div>
          </ion-item>
          <ion-item *ngIf="averageTime != 0" class="ion-text-center">
            <ion-label>
              {{ 'AverageWorkoutDuration' | translate }}
              {{ averageTime | date:'HH:mm:ss':'UTC'}} 
            </ion-label>
          </ion-item>

          <ion-item *ngIf="controls.IsPaused">
            <h1 style="width: 100%;" class="ion-text-center">
              {{ 'Paused' | translate }}
            </h1>
          </ion-item>

        </ion-card>

      </ion-col>

      <ion-col id="exercises-list"
        sizeLg="8" sizeMd="7" sizeSm="12">

        <ion-grid>
          <ion-row>
            <ion-col class="table-header">
              {{ 'Exercises' | translate }}
            </ion-col>
            <ion-col
              *ngIf="results.length > 0"
              style="max-width: 90px;" class="table-header ion-text-center"> 
              {{ 'Result' | translate }}
            </ion-col>
            <ion-col
              style="max-width: 90px" class="table-header ion-text-center"> 
              {{ 'Goal' | translate }}
            </ion-col>
          </ion-row>
          <ion-row
            *ngFor="let exercise of sheetData.Params; let i = index">
            <ion-col>
              <ion-icon *ngIf="i == current.ExerciseIndex && !controls.IsFinished" name="play"></ion-icon>
              {{ exercise.Title }}
            </ion-col>
            <ion-col
              *ngIf="results[i] != null"
              style="max-width: 80px; text-align: center">
              <ion-label *ngIf="exercise.Type != 'Bool'; else showBool">
                {{ results[i] }}
              </ion-label>
              <ng-template #showBool>
                <ion-icon name="checkbox" *ngIf="results[i] == 'true'"></ion-icon>
                <ion-icon name="close" *ngIf="results[i] != 'true'"></ion-icon>
              </ng-template>
            </ion-col>
            <ion-col
              style="max-width: 80px"
              class="ion-text-center">
              <ion-label *ngIf="exercise.Type != 'Bool'; else showBool">
                {{ exercise.Goal }}
              </ion-label>
              <ng-template #showBool>
                <ion-icon name="checkbox" *ngIf="exercise.Goal == 'true'"></ion-icon>
                <ion-icon name="close" *ngIf="exercise.Goal != 'true'"></ion-icon>
              </ng-template>
            </ion-col>
          </ion-row>
        </ion-grid>

      </ion-col>

    </ion-row>

  </ion-grid>


</ion-content>

<ion-footer style="padding: 0.5rem">

  <ion-segment *ngIf="!controls.IsFinished">

    <ion-segment-button
      *ngIf="current.ExerciseIndex != null"
      (click)="terminateWorkout()">
      <ion-icon name="square"></ion-icon>
    </ion-segment-button>

    <ion-segment-button
      (click)="startWorkout()"
      *ngIf="current.ExerciseIndex == null">
      <ion-icon name="play" color="primary"></ion-icon>
    </ion-segment-button>

    <ion-segment-button
      *ngIf="current.ExerciseIndex != null && current.ExerciseIndex < exerciseNumber - 1"
      [disabled]="controls.IsABreak || controls.IsPaused"
      (click)="markAsCompleted()">
      <ion-icon name="checkmark" color="primary"></ion-icon>
    </ion-segment-button>

    <ion-segment-button
      *ngIf="current.ExerciseIndex == exerciseNumber - 1 && !controls.IsFinished"
      (click)="finish()">
      <ion-icon name="checkmark" color="primary"></ion-icon>
    </ion-segment-button>

    <ion-segment-button
      *ngIf="!controls.IsPaused && current.ExerciseIndex != null; else playButton"
      (click)="pauseWorkout()">
      <ion-icon name="pause"></ion-icon>
    </ion-segment-button>

    <ng-template #playButton>
      <ion-segment-button
        *ngIf="current.ExerciseIndex != null"
        (click)="playWorkout()">
        <ion-icon name="play" color="warning"></ion-icon>
      </ion-segment-button>
    </ng-template>

  </ion-segment>

</ion-footer>
